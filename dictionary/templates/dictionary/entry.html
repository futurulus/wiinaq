{% extends "dictionary/base.html" %}

{% block content %}
<div class="listing">
    <h1>{{ chunk.entry }}</h1>

    <p class="listing-defn"><span class="pos">{{ chunk.pos }}</span> {{ chunk.defn }}</p>

    <p class="sources">Source: <span class="source">{{ chunk.source }}</span></p>

    {% if inflections %}
    <div class="popout">
        <h2 class="popout-header">Endings</h2>

        {% for table in inflections %}
        <h3>{{ table.title }}</h3>
        <table class="inflection" id="{{ table.id }}">
            <tr>
                <th />
                {% for h in table.column_headers %}
                <th>{{ h }}</th>
                {% endfor %}
            </tr>
            {% for r in table.rows %}
            <tr>
                <th>{{ r.header }}</th>
                {% for c in r.cells %}
                <td class="inflection-entry" id="{{ c.id }}">
                    {% for id, entry in c.map.items %}
                    <span class="inflection-option hide" id="{{ id }}">{{ entry }}</span>
                    {% endfor %}
                </td>
                {% endfor %}
            </tr>
            {% endfor %}
        </table>

        <script>
        endings.row_span["{{ table.id }}"] = {
        {% for cell_id, conditions in table.row_span.items %}
            "{{ cell_id }}": "{{ conditions }}",
        {% endfor %}
        };

        endings.col_span["{{ table.id }}"] = {
        {% for cell_id, conditions in table.col_span.items %}
            "{{ cell_id }}": "{{ conditions }}",
        {% endfor %}
        };

        endings.collapse["{{ table.id }}"] = {
        {% for cell_id, conditions in table.collapse.items %}
            "{{ cell_id }}": "{{ conditions }}",
        {% endfor %}
        };

        endings.activate_cell("{{ table.default }}");
        </script>
        {% endfor %}

        <p class="disclaimer">(Endings are automatically generated. Help us out by reporting
        errors!)</p>
    </div>
    {% endif %}
</div>
{% endblock %}
